
# Version

## 12

## 11
* [POSTGRESQL 11 BETA 1 RELEASED!](https://www.postgresql.org/about/news/1855/)
  * [HN](https://news.ycombinator.com/item?id=17144221)
* [Appendix E. Release Notes](https://www.postgresql.org/docs/11/static/release-11.html)
  * 分片
    * 支持使用 hash 键分片
    * UPDATE 更新分片键时可以将数据更新到正确的分片
    * SELECT 性能提升
    * 对于分片表支持 PRIMARY KEY, FOREIGN KEY, 索引和触发器
  * 并行
    * 并行 hash join
    * 并行 CREATE INDEX 创建 B-tree 索引
    * 并行 CREATE TABLE .. AS, CREATE MATERIALIZED VIEW 和一些 UNION 操作
  * SQL 存储过程
    * 支持内嵌事务
    * 使用 CALL 执行, CREATE/DROP/ALTER PROCEDURE
    * 也可以使用 DROP/ALTER ROUTINE 删除和修改, 也可以操作函数和聚合
    * 现在的存储函数是在事务内执行
    * 事务的操作只能在顶层存储过程
    * https://www.postgresql.org/docs/11/static/xproc.html
  * 部分 SQL JIT
  * 窗口函数支持所有 SQL:2011 标准, 包括 RANGE distance PRECEDING/FOLLOWING, GROUPS mode, and frame exclusion options
  * 之前 ALTER TABLE .. ADD COLUMN 并且 DEFAULT 为 non-null 时会重写整个表, 现在大部分情况下都不会, 这类操作会相当快
  * 支持使用 quit 和 exit 退出

## 10
* [New in postgres 10](https://wiki.postgresql.org/wiki/New_in_postgres_10)
* [PostgreSQL 10 New Features With Examples](http://h50146.www5.hpe.com/products/software/oe/linux/mainstream/support/lcc/pdf/PostgreSQL_10_New_Features_en_20170522-1.pdf)

* https://blog.2ndquadrant.com/postgresql-10-identity-columns/
* The identity property is not inherited. For a serial column, the default expression is inherited but the sequence ownership is not (similar to the LIKE case).
```sql
-- 之前
-- serial 不会被语句重现
-- 会有序列归属问题
CREATE TABLE test_old (
    id serial PRIMARY KEY,
    payload text
);

INSERT INTO test_old (payload) VALUES ('a'), ('b'), ('c') RETURNING *;

-- 之后
-- 符合 SQL 标准, 兼容 DB2, Oracle
-- 语句重现
CREATE TABLE test_new (
    id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    payload text
);

INSERT INTO test_new (payload) VALUES ('a'), ('b'), ('c') RETURNING *;
```

## 9.x

